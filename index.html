
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Written by Thorsten Ball</title>
  <meta name="author" content="Thorsten Ball">

  
  <meta name="description" content="I&#8217;ve been a Vim user for a long time but only in the last year I actually
started to really use it. No, I don&#8217;t mean to say that I spend &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://mrnugget.github.com/">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/atom.xml" rel="alternate" title="Written by Thorsten Ball" type="application/atom+xml">
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-32543112-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body    class="collapse-sidebar sidebar-footer" >
  <header role="banner"><hgroup>
  <h1><a href="/">Written by Thorsten Ball</a></h1>
  
</hgroup>

</header>
  <nav role="navigation">  
<ul class="main-navigation">
  <li><a href="/">Home</a></li>
  <li><a href="/blog/archives">Posts</a></li>
  <li><a href="http://www.github.com/mrnugget">Github</a></li>
  <li><a href="http://www.twitter.com/herrbrocken">Twitter</a></li>
</ul>
<ul class="subscription">
  <li><a href="/atom.xml" alt="Subscribe to the RSS feed">RSS</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2012/07/09/vim-learning-resources/">Vim Learning Resources</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2012-07-09T11:35:00+02:00" pubdate data-updated="true">Jul 9<span>th</span>, 2012</time>
        
         | <a href="/blog/2012/07/09/vim-learning-resources/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>I&#8217;ve been a Vim user for a long time but only in the last year I actually
started to really use it. No, I don&#8217;t mean to say that I spend years of my
life with an opened editor on my workspace and just stared at it. What I really
mean is that those early years of my Vim usage and knowledge mostly consisted
of <em>h, j, k, l</em>, <em>:wq</em> and <em>:%s/replace/this/g</em>. That and syntax highlighting was
pretty much Vim for me.</p>

<p>One of the things that makes Vim so great for me is that it doesn&#8217;t force you to
use or understand something. I was able to get work done with just the basic
knowledge I had. But then came that moment when I stumbled upon a
blog post about Vim&#8217;s text objects and my jar dropped on my keyboard: <em>&#8220;So
that&#8217;s how it works?!&#8221;</em></p>

<p>Vim has a steep learning curve and there are bumps on the road where you can get
stuck. And I know a lot of people do get stuck. You may like it there, being
stuck, but keep in mind: sometimes it&#8217;s just a little tip that can get you
forward. A small push that gives you an <em>AHA!</em> moment. Thankfully there are a
lot of these available everywhere, though sometimes they are not that
easy to find, which is the reason I&#8217;m writing this post.</p>

<p>The following is a list consisting of screencasts, video tutorials, blog posts,
tips and tricks concerning Vim and how to master it. The items on the list are
the ones that got me forward when I was stuck on my way to Vim wizardry (mind
you, I&#8217;m not there yet, not even close but I&#8217;m wearing the nice hat anyway). I
bet someone can find some use in this.</p>

</div>
  
  
    <footer>
      <a rel="full-article" href="/blog/2012/07/09/vim-learning-resources/">Read on &rarr;</a>
    </footer>
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2012/06/20/how-i-used-98840-commands-less-and-saved-4-seconds/">How I Used 98840 Commands Less and Saved 4 Seconds</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2012-06-20T18:58:00+02:00" pubdate data-updated="true">Jun 20<span>th</span>, 2012</time>
        
         | <a href="/blog/2012/06/20/how-i-used-98840-commands-less-and-saved-4-seconds/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>In my last post I explained how to implement a search autocompletion backend
using Redis. This week I used the described implementation with its <code>add_movie</code> method to put thousands of movies into my Redis database
in order to use them for the autocompletion on
<a href="http://anygood.heroku.com" title="AnyGood - Check if a movie was
any good!">anygood.heroku.com</a>. It&#8217;s the same method as described in the last post, but with
important change I didn&#8217;t think about too much: I did not overwrite the score of the members in the sorted
sets. The method I used for adding movies looked like this:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">def</span> <span class="nf">add_movie</span><span class="p">(</span><span class="n">movie_hash</span><span class="p">)</span>
</span><span class='line'>  <span class="n">prefixes</span>    <span class="o">=</span> <span class="n">prefixes_for</span><span class="p">(</span><span class="n">movie_hash</span><span class="o">[</span><span class="ss">:name</span><span class="o">]</span><span class="p">)</span>
</span><span class='line'>  <span class="n">hashed_name</span> <span class="o">=</span> <span class="n">data_hash_key_for</span><span class="p">(</span><span class="n">movie_hash</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">prefixes</span><span class="o">.</span><span class="n">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">prefix</span><span class="o">|</span>
</span><span class='line'>    <span class="n">score</span> <span class="o">=</span> <span class="no">REDIS</span><span class="o">.</span><span class="n">zscore</span><span class="p">(</span><span class="n">index_key_for</span><span class="p">(</span><span class="n">prefix</span><span class="p">),</span> <span class="n">hashed_name</span><span class="p">)</span><span class="o">.</span><span class="n">to_i</span> <span class="o">||</span> <span class="mi">0</span>
</span><span class='line'>    <span class="no">REDIS</span><span class="o">.</span><span class="n">zadd</span><span class="p">(</span><span class="n">index_key_for</span><span class="p">(</span><span class="n">prefix</span><span class="p">),</span> <span class="n">score</span><span class="p">,</span> <span class="n">hashed_name</span><span class="p">)</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>    <span class="no">REDIS</span><span class="o">.</span><span class="n">hset</span><span class="p">(</span><span class="n">data_key</span><span class="p">,</span> <span class="n">hashed_name</span><span class="p">,</span> <span class="n">movie_hash</span><span class="o">.</span><span class="n">to_json</span><span class="p">)</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>Adding movies took suspiciously long, longer than I thought it would.
Looking at it now it&#8217;s pretty easy to tell why: it was exactly that small change
that lowered the speed of my importing process, I <em>did</em> cache the member score
in <em>every</em> prefix set and then used in the <code>REDIS.zadd</code> line. Every time a movie
was added, for each of its prefixes the score of the correspondent sorted set
member was saved and used again. That&#8217;s not bad at all, no, it didn&#8217;t slip in
there either! Heck, I wrote tests for this. But looking at the code I concluded
that it was not a feature I needed. Using the code above, every movie would have
a different rank in the autocomplete output according to the user input. One
movie could be ranked higher when the user typed in <em>the</em> and ranked lower when
the input was <em>dark</em>. That is pretty cool, but I wanted a different behaviour:
the sorted set members associated with one movie should have one score, the same
one in every set. And after running some benchmarks I found out how implementing
the wrong behaviour slowed me down.</p>

</div>
  
  
    <footer>
      <a rel="full-article" href="/blog/2012/06/20/how-i-used-98840-commands-less-and-saved-4-seconds/">Read on &rarr;</a>
    </footer>
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2012/06/08/search-autocompletion-with-redis/">Ordered Search Autocompletion With Redis</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2012-06-08T16:42:00+02:00" pubdate data-updated="true">Jun 8<span>th</span>, 2012</time>
        
         | <a href="/blog/2012/06/08/search-autocompletion-with-redis/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>I spent the last weekend building a caching system for <a href="http://anygood.heroku.com" title="Any Good">AnyGood</a>
using <a href="http://www.redis.io" title="Redis">Redis</a> to save API responses for certain
amount of time. Since the next item on my TODO list was autocompletion for my search
form I started googling around looking for solutions involving Redis and I
stumbled about two great posts examining this particular topic. The <a href="http://antirez.com/post/autocomplete-with-redis.html" title="Autocomplete with Redis">first one</a>
written by Salvatore Sanfilippo is a great explanation on how to use
Redis for autocompletion and goes in great detail when explainin the algorithm.
And the <a href="http://patshaughnessy.net/2011/11/29/two-ways-of-using-redis-to-build-a-nosql-autocomplete-search-index" title="Two ways of using Redis to build a NoSQL autocomplete search index">second one</a>
by Pat Shaughnessy is a great help when explaining Sanfilippos algorithm and comparing
it to <a href="https://github.com/seatgeek/soulmate" title="Soulmate">Soulmate</a>, &#8220;a tool to
help solve the common problem of developing a fast autocomplete feature. It uses
Redis&#8217;s sorted sets to build an index of partially completed words and the
corresponding top matching items, and provides a simple sinatra app to query
them.&#8221;</p>

<p>So I spent a good amount of time studying those articles and reading through the
source code of Soulmate before I decided to write my own solution. Why? Because
it was a rainy sunday afternoon, playing around with Redis is fun and I wanted
to learn more about it. And after all, I wanted support for multiple phrases,
search result ordering and Soulmate did all that and a bit more and just setting
it up wouldn&#8217;t have the same learning effect. And since I was out to play, I
might as well have fun. So let&#8217;s see how to this&#8230;</p>

</div>
  
  
    <footer>
      <a rel="full-article" href="/blog/2012/06/08/search-autocompletion-with-redis/">Read on &rarr;</a>
    </footer>
  


    </article>
  
  <div class="pagination">
    
    
  </div>
</div>
<aside class="sidebar">
  
    <section class="about">
  <h1>About Me</h1>
  <img src="/images/avatar.jpg">
  <p>I&#8217;m 24 years old, living in Berlin, Germany and I want to write about
  things that I&#8217;m interested in: Ruby, Ruby on Rails, Web Development, Music and
  Guitars!</p>
  <p>I&#8217;m currently doing an internship programming Ruby and developing web
  applications with Ruby on Rails.</p>
  <p>If you want to contact me via e-mail: <a href="http://www.github.com/mrnugget">my github username</a>
  at gmail.com</p>
</section>
<section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2012/07/09/vim-learning-resources/">Vim Learning Resources</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/06/20/how-i-used-98840-commands-less-and-saved-4-seconds/">How I used 98840 commands less and saved 4 seconds</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/06/08/search-autocompletion-with-redis/">Ordered Search Autocompletion With Redis</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>Latest Tweets</h1>
  <ul id="tweets">
    <li class="loading">Status updating&#8230;</li>
  </ul>
  <script type="text/javascript">
    $.domReady(function(){
      getTwitterFeed("herrbrocken", 4, false);
    });
  </script>
  <script src="/javascripts/twitter.js" type="text/javascript"> </script>
  
    <a href="http://twitter.com/herrbrocken" class="twitter-follow-button" data-show-count="false">Follow @herrbrocken</a>
  
</section>


  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2012 - Thorsten Ball
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'writtenbythorstenball';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
